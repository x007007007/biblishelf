Database Schema
===============

.. uml::

    @startuml

    skinparam defaultFontName Courier

    Class Repo {
        INTEGER      ★ id
        VARCHAR[128] ⚪ uuid
    }

    Class VRepo {
        INTEGER ★ id
        INTEGER ☆ large_file_id
        INTEGER ☆ normal_file_id
        +       large_file
        +       normal_file
    }

    Class LargeFile {
        INTEGER ★ id
        INTEGER ☆ resource_id
        BLOB    ⚪ ed2k
        BLOB    ⚪ md5
        BLOB    ⚪ sha256
        BLOB    ⚪ sha512
        INTEGER ⚪ size
        +       resource
    }

    Class SmallFile {
        INTEGER ★ id
        INTEGER ☆ resource_id
        BLOB    ⚪ md5
        INTEGER ⚪ size
        +       resource
    }

    Class NormalFile {
        INTEGER ★ id
        INTEGER ☆ resource_id
        BLOB    ⚪ ed2k
        BLOB    ⚪ md5
        BLOB    ⚪ sha256
        INTEGER ⚪ size
        +       resource
    }

    Class Resource {
        INTEGER ★ id
    }

    Class Location {
        INTEGER ★ id
        INTEGER ☆ large_file_id
        INTEGER ☆ normal_file_id
        INTEGER ☆ repo_id
        INTEGER ☆ small_file_id
        INTEGER ☆ vrepo_id
        TEXT    ⚪ uri
        +       large_file
        +       normal_file
        +       repo
        +       small_file
        +       vrepo
    }

    VRepo <--o NormalFile: normal_file_id

    VRepo <--o LargeFile: large_file_id

    LargeFile <--o Resource: resource_id

    SmallFile <--o Resource: resource_id

    NormalFile <--o Resource: resource_id

    Location <--o Repo: repo_id

    Location <--o VRepo: vrepo_id

    Location <--o NormalFile: normal_file_id

    Location <--o SmallFile: small_file_id

    Location <--o LargeFile: large_file_id

    right footer generated by sadisplay v0.4.8

    @enduml
